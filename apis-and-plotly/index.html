
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">

        <title>APIs and Plotly</title>

        <link href="../assets/css/bootstrap.min.css?v=e546114afd" rel="stylesheet">
        <link href="../assets/css/bootflat.min.css?v=e546114afd" rel="stylesheet">
		<link href="../assets/css/octicons.css?v=e546114afd" rel="stylesheet">
        <link href="../assets/css/app.css?v=e546114afd" rel="stylesheet">

        <link rel="shortcut icon" href="../favicon.ico">

        <link rel="canonical" href="index.html">
    
    <meta property="og:site_name" content="Build It Green">
    <meta property="og:type" content="article">
    <meta property="og:title" content="APIs and Plotly">
    <meta property="og:description" content="As Mark and I have gotten our workflow down for this project, I have really begun to understand the importance of communication between the back end and front end.  When I’m designing the API endpoints, organization matters, and the...">
    <meta property="og:url" content="http://localhost:2368/apis-and-plotly/">
    <meta property="article:published_time" content="2015-07-17T01:43:02.685Z">
    <meta property="article:modified_time" content="2015-07-17T01:43:04.646Z">
    
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="APIs and Plotly">
    <meta name="twitter:description" content="As Mark and I have gotten our workflow down for this project, I have really begun to understand the importance of communication between the back end and front end.  When I’m designing the API endpoints, organization matters, and the...">
    <meta name="twitter:url" content="http://localhost:2368/apis-and-plotly/">
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Build It Green",
    "author": {
        "@type": "Person",
        "name": "josh higgins",
        "url": "http://localhost:2368/author/josh",
        "sameAs": null,
        "description": null
    },
    "headline": "APIs and Plotly",
    "url": "http://localhost:2368/apis-and-plotly/",
    "datePublished": "2015-07-17T01:43:02.685Z",
    "dateModified": "2015-07-17T01:43:04.646Z",
    "description": "As Mark and I have gotten our workflow down for this project, I have really begun to understand the importance of communication between the back end and front end.  When I’m designing the API endpoints, organization matters, and the..."
}
    </script>

    <meta name="generator" content="Ghost 0.6">
    <link rel="alternate" type="application/rss+xml" title="Build It Green" href="../rss/index.html">
    </head>
    <body>
        <div id="wrap">
            <div class="navbar navbar-inverse navbar-static-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand pull-left" href="../"> Build It Green</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="nav-home">
  <a href="../">
    Home
  </a>
</li>

            </ul>
            <ul class="nav navbar-nav navbar-right">
                <!--
                <li><a href="#"><span class="octicon octicon-mention"></span> Follow me</a></li>
                <li><a href="#"><span class="octicon octicon-mark-github"></span> Fork me</a></li>
                -->
                <li><a href="../rss/index.rss"><span class="octicon octicon-rss"></span> RSS</a></li>
		<li><a href="http://localhost:2368/ghost/"><span class="octicon octicon-pencil"></span></a></li>
            </ul>
        </div>
    </div>
</div>
            
            

<div class="container-fluid container-abitabove">
    <div class="row">
        <div class="col-lg-12 centered text-center container-withcover no-cover" style="">
            <h1>APIs and Plotly</h1>
            <h5>
                <time datetime="2015-07-16"><span class="mega-octicon octicon-calendar"></span> 2015-07-16 at 21:43</time>
            </h5>
        </div>
    </div>
</div>
            
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 col-lg-offset-1 centered">
                        <main>
    <article class="post">
        <section class="posts">
            <p>As Mark and I have gotten our workflow down for this project, I have really begun to understand the importance of communication between the back end and front end.  When I’m designing the API endpoints, organization matters, and the closer I can get my endpoints to match the structure mark needs for his visualizations the better. </p>

<p>Mark and I talked and decided that structuring the API to serve the data better would be faster than him trying to parse a more complicated API.</p>

<p>To that end, I refactored the API for our breakdown of the credits that LEED projects attain on average.  This is data that has not been presented before, so it’s key that we get it right.  We want to present the data in both yearly trends and show differences between certification levels.  For me that means making some nested dictionaries that can be outputted as JSON for Mark’s D3 visualizations.</p>

<p>Each data point needs a query similar to:</p>

<pre><code>eqc_dict = {}
for credit in eqc_list:
eqc_dict[credit] = {}
for year in year_list:
    eqc_dict[credit][year] = float("     {0:.2f}".format((ScoreTwoPointTwo.objects
                                        .filter(project__certification_date__gte=datetime(year, 1, 1))
                                        .filter(project__certification_date__lte=datetime(year, 12, 31))
                                        .aggregate(Avg(credit))['{}__avg'.format(credit)]) /
                                   possible_dict[credit]))
for cert in cert_list:
    eqc_dict[credit][cert] = float("{0:.2f}".format((ScoreTwoPointTwo.objects
                                                    .filter(project__certification_level=cert)
                                                    .aggregate(Avg(credit))['{}__avg'.format(credit)]) /
                                                    possible_dict[credit]))
trends_dict["eqc"] = eqc_dict
</code></pre>

<p>This was a pretty complicated structure so I opted to write it out instead of trying to nest dictionary comprehensions.</p>

<h4>Plotly</h4>  

<p>In order to get more visualizations on Build It Green, I dug into plot.ly  — an awesome data visualization tool that works really well with Python and pandas.  I really wanted to make a bubble map that displayed LEED projects by city, so I took the morning yesterday and formatted my data to include latitude, longitude, and population for each city, along with a count of projects in each city.  Then I worked in an python notebook and plotly to plot my data.  Check it out:  <a href="https://plot.ly/~jdhiggins/41/leed-projects-1558-681-leed-projects-681-484-leed-projects-505-267-leed-projects/">https://plot.ly/~jdhiggins/41/leed-projects-1558-681-leed-projects-681-484-leed-projects-505-267-leed-projects/</a></p>
            <hr>
        </section>
    </article>
</main>
<!--
  Add comments code if needed, i.e. to include disqus
-->
<!-- <div id="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	    var disqus_shortname = 'replacethiswithyourname'; // required: replace example with your own shortname
	    var disqus_identifier = '';
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<a href="http://disqus.com" class="dsq-brlink">Comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<!-- End Comments Code -->
 --&gt;

                    </div>
                </div>
            </div>
        </div>

        <div id="footer">
            <footer>
    <div class="footer text-center">
      <div class="container">
          <div class="row">
              <div class="col-lg-10 col-lg-offset-1 centered">
                © Copyright Build It Green • powered by Ghost • <a href="https://github.com/fabienwang/Ghost-Flat"><span class="octicon octicon-mark-github"></span> Ghost-Flat</a> theme
              </div>
          </div>
      </div>
  </div>
</footer>
        </div>

        <script src="../public/jquery.js?v=e546114afd"></script>
        <script src="../assets/js/d3.min.js?v=e546114afd"></script>
        <script src="../assets/js/lodash.min.js?v=e546114afd"></script>
        <script src="../assets/js/icheck.min.js?v=e546114afd"></script>
        <script src="../assets/js/jquery.fs.selecter.min.js?v=e546114afd"></script>
        <script src="../assets/js/jquery.fs.stepper.min.js?v=e546114afd"></script>
        <script src="../assets/js/os-vis.js?v=e546114afd"></script>
        <script src="../assets/js/bootstrap.min.js?v=e546114afd"></script>
        <script src="../assets/js/ghost-blog.js?v=e546114afd"></script>
    </body>
